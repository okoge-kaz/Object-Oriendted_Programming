# 2021年度オブジェクト指向基礎・最終課題

以下のデータベースとなるプログラムを作成せよ。
また、そのプログラムに関して、実装した範囲および仕様以外の拡張（コマンドの追加やコマンドの連続実行など）を行った箇所について、説明を`Report.txt`に記せ。特に拡張を行った場合、必ず入力方法を記述せよ。仕様を過不足無く実装した場合はそのように記述すること。

なお、部分的に実装する場合、入出力例を目標に実装すること。


## 締め切り
2/10(木) 23:59（日本時間）

## 用語

- **フィールド**は文字列である。
- **レコード**は、複数のフィールドからなる。レコード内でフィールドの順序は固定とする。
- **テーブル**は、複数のレコードからなる。すべてのレコードが含むフィールド数は同一である。レコードの順序は固定しなくても良い。
- テーブルにおいて、レコードの同一箇所にあるものをまとめて**カラム**と呼ぶ。カラムを指定するために、各テーブルで「何番目か」を表す名前を付ける。この名前を**カラム名**と呼ぶ。
- **データベース**は、複数のテーブルからなる。それぞれのテーブルのレコード数やその中のレコードのフィールド数は異なって良い。異なるテーブル間でカラム名が重複しても良い。


## プログラムの仕様

作成するプログラムは、以下の書式のコマンドを読み取り実行する。
以下、大文字始まりの部分は名前などを表している。実際に名前を大文字始まりにする必要はない。

- `create Tbl Col1 Col2 ... Coln` : `Tbl`という名前の空のテーブルを作成する。カラム名は前から順に`Col1`、`Col2`、...、`Coln`である。
- `list` : テーブル名の一覧を作成する。（書式は実行例を参照）
- `delete Tbl` : `Tbl`という名前のテーブルを削除する。
- `show Tbl` : `Tbl`という名前のテーブルの名前、カラム名一覧、およびすべてのレコードを表示する。（書式は実行例を参照）
- `insert Tbl Fld1 Fld2 ... Fldn` : `Tbl`という名前のテーブルに、フィールドが順に`Fld1`、`Fld2`、...、`Fldn`であるようなレコードを追加する。
- `remove Tbl Col Fld` : `Tbl`という名前のテーブルから、レコードのカラム名`Col`のフィールドが`Fld`であるようなものをすべて取り除く。
- `update Tbl Col1 Fld1 Col2 Fld2` : `Tbl`という名前のテーブルのレコードのうち、カラム名`Col1`のフィールドが`Fld1`であるようなもののカラム名`Col2`の要素を`Fld2`に置き換える。
- `rename Tbl Col1 Col2` : `Tbl`という名前のテーブルのカラム名`Col1`を`Col2`に変更する。
- `select Tbl1 Col Fld Tbl2` : `Tbl1`という名前のテーブルのレコードのうち、カラム名`Col`のフィールドが`Fld`であるようなものを`Tbl2`に追加する。
- `proj Tbl1 Tbl2` : `Tbl1`という名前のテーブルのレコードを`Tbl2`のカラム名に合わせて追加する。`Tbl2`のカラム名はすべて`Tbl1`に含まれている必要がある。
- `join Tbl1 Col1 Tbl2 Col2 Tbl3` : `Tbl1`という名前のテーブルのレコードと`Tbl2`という名前のテーブルのレコードについて、`Tbl1`側のレコードのカラム名`Col1`のフィールドと`Tbl2`側のレコードのカラム名`Col2`のフィールドが一致するものを結合して、`Tbl3`に追加する。
- `load File` : `File`という名前のファイルから行単位で文字列を読み取り、コマンドとして解釈して実行する。
- `save Tbl File` : `Tbl`という名前のテーブルについて、`Tbl`を作成するコマンドと内部のレコードを`Tbl`に追加するコマンド列からなるファイル`File`を生成する。

実行時には以下の条件が満たされることを想定して良い。
- 名前とフィールドは英数字またはアンダースコア、ピリオドだけで構成される。
- `create`以外では指定するテーブルが存在すること。`create`で指定するテーブルは存在しないこと。
- 単一のテーブル内でカラム名は重複しないこと。異なるテーブル間での重複は問題ないが、試行時に`rename`で重複する可能性に注意。
- `insert Tbl Fld1 Fld2 ... Fldn`では`Tbl`の作成時のカラム名の数とフィールド数（`n`）が一致すること。
- `select Tbl1 Col Fld Tbl2`では`Tbl1`と`Tbl2`が同一のカラム名を同一順序で持つこと。
- `proj Tbl1 Tbl2`では`Tbl2`のカラム名がすべて`Tbl1`に含まれる必要がある。ただし出現順序が同一である必要はない。
- `join Tbl1 Col1 Tbl2 Col2 Tbl3`では`Tbl1`と`Tbl2`のカラム名に重複がなく、`Tbl3`のカラム名は`Tbl1`に出現するカラム名と`Tbl2`に出現するカラム名を順に並べたものであること。
- `load File`は適切に読めるコマンドの列が書かれたファイルが存在する。
- `save Tbl File`は`File`が存在しない状態で実行する。（存在した場合にエラーを出す必要はないので自然に上書きになるはずだが、採点は存在しない状態を作って行う）


## 入出力例

入力例は`sample_input_0.txt`から`sample_input_3.txt`まで用意されている。
対応する出力例は`sample_output_0.txt`から`sample_output_3.txt`がある。
出力例はテーブル内のレコードの順序が不定なため異なることがある。`diff`コマンドで比較する場合は気をつけること。

それぞれの入力例の使っている機能は以下の通りである。

+ `sample_input_0.txt` : `create`、`list`、`delete`を利用。テーブルの中身には触れない。
+ `sample_input_1.txt` : 0に加えて、`insert`、`remove`、`update`、`show`を利用。単一テーブルのカラムを変更しない操作を行う。
+ `sample_input_2.txt` : 1に加えて、`load`、`save`、`rename`を利用。
	+ `save`の先（`sample_output_save.txt`）の例は`sample_save_2.txt`を参照。
+ `sample_input_3.txt` : すべて利用。


## 制限事項

以下の制限事項に違反する場合、本課題の点数は自動で0点となるので注意すること。

+ `Main5`以外のクラスを最低でも2つ定義すること。ただしこの講義は設計の講義ではないため、クラスの設計内容に関しては評価の対象としない。
+ `Main5`以外のクラスは無名パッケージ以外のパッケージ内に存在すること。（パッケージ名は指定しないので自由に設定せよ）
+ 入力例に対して出力例を読み込むなど、明らかにコマンドの解釈をしていないような実装としないこと。

なお、盗用・剽窃などの行為を行った場合には本課題だけでなく本講義の得点そのものを0点とする。


## 注意事項

+ 入力は正しく条件を満たす場合に動作すれば十分だが、正しくない入力に対してプログラムを停止させるかエラーメッセージを出力して続行するかなどは自由に決めてよい。
+ 入出力例では発生しないが、単一のテーブル内で複数の同一レコード（すべてのカラム名でフィールドが一致するレコード）が存在しても良い（`insert`や`update`で発生する場合がある）し、そのような場合に同一レコードが唯一になるように処理をしても良い。ただし`remove`で対象になった場合はすべて取り除かれなければならない。
+ 実行例はフィールドに数字ばかり用いているが、数値として扱ってはいない。
